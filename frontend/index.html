<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vinted Scraper Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #f5f5f5;
            color: #333;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        .header p {
            opacity: 0.9;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        .tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid #e0e0e0;
        }
        .tab {
            padding: 1rem 2rem;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }
        .tab:hover {
            color: #667eea;
        }
        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .stat-label {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
        }
        .card {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }
        .card h2 {
            margin-bottom: 1.5rem;
            color: #333;
        }
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s;
        }
        .btn-primary {
            background: #667eea;
            color: white;
        }
        .btn-primary:hover {
            background: #5568d3;
            transform: translateY(-1px);
        }
        .btn-success {
            background: #48bb78;
            color: white;
        }
        .btn-danger {
            background: #f56565;
            color: white;
        }
        .listing-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }
        .listing-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        .listing-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.15);
        }
        .listing-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            background: #f0f0f0;
        }
        .listing-content {
            padding: 1rem;
        }
        .listing-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #333;
            font-size: 1rem;
        }
        .listing-price {
            color: #667eea;
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        .listing-meta {
            font-size: 0.85rem;
            color: #666;
        }
        .form-group {
            margin-bottom: 1.5rem;
        }
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #333;
        }
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }
        .config-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        .config-item {
            background: #f9f9f9;
            padding: 1.5rem;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .config-info h3 {
            margin-bottom: 0.5rem;
        }
        .config-info p {
            font-size: 0.9rem;
            color: #666;
            margin: 0.25rem 0;
        }
        .config-actions {
            display: flex;
            gap: 0.5rem;
        }
        .status-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        .status-success { background: #c6f6d5; color: #22543d; }
        .status-running { background: #fef5e7; color: #744210; }
        .status-failed { background: #fed7d7; color: #742a2a; }
        .loading {
            text-align: center;
            padding: 2rem;
            color: #666;
        }
        .empty-state {
            text-align: center;
            padding: 3rem;
            color: #999;
        }
        .search-box {
            margin-bottom: 1.5rem;
        }
        .search-box input {
            width: 100%;
            padding: 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
        }
        .view-toggle {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }
        .view-toggle button {
            padding: 0.5rem 1rem;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .view-toggle button.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        .listings-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }
        .listings-table th {
            background: #f9f9f9;
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #e0e0e0;
            position: sticky;
            top: 0;
        }
        .listings-table td {
            padding: 1rem;
            border-bottom: 1px solid #f0f0f0;
        }
        .listings-table tr:hover {
            background: #f9f9f9;
        }
        .table-image {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 8px;
        }
        .price-change {
            font-size: 0.85rem;
            margin-top: 0.25rem;
        }
        .price-up {
            color: #f56565;
        }
        .price-down {
            color: #48bb78;
        }
        .price-stable {
            color: #999;
        }
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #999;
        }
        .price-history-chart {
            margin-top: 1.5rem;
        }
        .price-history-item {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem;
            border-bottom: 1px solid #f0f0f0;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="header">
            <h1>Vinted Scraper Dashboard</h1>
            <p>Manage your product scraping and price tracking</p>
        </div>

        <div class="container">
            <!-- Stats Overview -->
            <div class="stats-grid" v-if="currentTab === 'dashboard'">
                <div class="stat-card">
                    <div class="stat-label">Total Listings</div>
                    <div class="stat-value">{{ stats.total_listings || 0 }}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Active Listings</div>
                    <div class="stat-value">{{ stats.active_listings || 0 }}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Scraped Today</div>
                    <div class="stat-value">{{ stats.total_scraped_today || 0 }}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Active Configs</div>
                    <div class="stat-value">{{ stats.active_configs || 0 }}</div>
                </div>
                <div class="stat-card" v-if="stats.avg_price_cents">
                    <div class="stat-label">Avg Price</div>
                    <div class="stat-value">{{ (stats.avg_price_cents / 100).toFixed(2) }} EUR</div>
                </div>
            </div>

            <!-- Tabs -->
            <div class="tabs">
                <button class="tab" :class="{active: currentTab === 'dashboard'}" @click="currentTab = 'dashboard'">
                    Dashboard
                </button>
                <button class="tab" :class="{active: currentTab === 'listings'}" @click="currentTab = 'listings'">
                    Listings
                </button>
                <button class="tab" :class="{active: currentTab === 'configs'}" @click="currentTab = 'configs'">
                    Scrape Configs
                </button>
            </div>

            <!-- Dashboard Tab -->
            <div v-if="currentTab === 'dashboard'" class="card">
                <h2>Recent Activity</h2>
                <p style="color: #666;">View your listings and configurations in the tabs above.</p>
            </div>

            <!-- Listings Tab -->
            <div v-if="currentTab === 'listings'">
                <div class="card">
                    <div class="search-box">
                        <input v-model="searchQuery" @input="searchListings" placeholder="Search listings...">
                    </div>

                    <div class="view-toggle">
                        <button :class="{active: viewMode === 'grid'}" @click="viewMode = 'grid'">
                            Grid View
                        </button>
                        <button :class="{active: viewMode === 'table'}" @click="viewMode = 'table'">
                            Table View
                        </button>
                    </div>

                    <div v-if="loadingListings" class="loading">Loading listings...</div>
                    <div v-else-if="listings.length === 0" class="empty-state">
                        No listings found. Create a scrape configuration to get started!
                    </div>

                    <!-- Grid View -->
                    <div v-else-if="viewMode === 'grid'" class="listing-grid">
                        <div v-for="listing in listings" :key="listing.id" class="listing-card" @click="showPriceHistory(listing.id)">
                            <img v-if="listing.photo" :src="listing.photo" :alt="listing.title" class="listing-image">
                            <div v-else class="listing-image" style="display: flex; align-items: center; justify-content: center; color: #999;">
                                No Image
                            </div>
                            <div class="listing-content">
                                <div class="listing-title">{{ listing.title }}</div>
                                <div class="listing-price" v-if="listing.price_cents">
                                    {{ (listing.price_cents / 100).toFixed(2) }} {{ listing.currency || 'EUR' }}
                                </div>
                                <div class="listing-meta">
                                    <div v-if="listing.seller_name">Seller: {{ listing.seller_name }}</div>
                                    <div v-if="listing.location">Location: {{ listing.location }}</div>
                                    <a :href="listing.url" target="_blank" style="color: #667eea;" @click.stop>View on Vinted</a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Table View -->
                    <div v-else style="overflow-x: auto;">
                        <table class="listings-table">
                            <thead>
                                <tr>
                                    <th>Image</th>
                                    <th>Title</th>
                                    <th>Price</th>
                                    <th>Description</th>
                                    <th>Lang</th>
                                    <th>Seller</th>
                                    <th>Location</th>
                                    <th>First Seen</th>
                                    <th>Last Seen</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="listing in listings" :key="listing.id">
                                    <td>
                                        <img v-if="listing.photo" :src="listing.photo" :alt="listing.title" class="table-image">
                                        <div v-else style="width: 60px; height: 60px; background: #f0f0f0; border-radius: 8px;"></div>
                                    </td>
                                    <td>
                                        <div style="max-width: 250px;">{{ listing.title }}</div>
                                    </td>
                                    <td>
                                        <div style="font-weight: 600; color: #667eea;">
                                            {{ listing.price_cents ? (listing.price_cents / 100).toFixed(2) : 'N/A' }} {{ listing.currency || 'EUR' }}
                                        </div>
                                        <div v-if="listing.previous_price_cents && listing.price_change" class="price-change" :class="{
                                            'price-up': listing.price_change === 'up',
                                            'price-down': listing.price_change === 'down',
                                            'price-stable': listing.price_change === 'same'
                                        }">
                                            <span v-if="listing.price_change === 'up'">↑</span>
                                            <span v-else-if="listing.price_change === 'down'">↓</span>
                                            <span v-else>→</span>
                                            was {{ (listing.previous_price_cents / 100).toFixed(2) }}
                                        </div>
                                        <button class="btn" style="font-size: 0.8rem; padding: 0.25rem 0.5rem; margin-top: 0.5rem;" @click="showPriceHistory(listing.id)">
                                            History
                                        </button>
                                    </td>
                                    <td>
                                        <div style="max-width: 200px; font-size: 0.85rem; color: #666; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" :title="listing.description">
                                            {{ listing.description || 'N/A' }}
                                        </div>
                                    </td>
                                    <td>{{ listing.language || 'N/A' }}</td>
                                    <td>{{ listing.seller_name || 'N/A' }}</td>
                                    <td>{{ listing.location || 'N/A' }}</td>
                                    <td>{{ new Date(listing.first_seen_at).toLocaleDateString() }}</td>
                                    <td>{{ new Date(listing.last_seen_at).toLocaleDateString() }}</td>
                                    <td>
                                        <a :href="listing.url" target="_blank" class="btn btn-primary" style="font-size: 0.8rem; padding: 0.5rem;">
                                            View
                                        </a>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div v-if="listings.length > 0" style="margin-top: 2rem; text-align: center;">
                        <button class="btn btn-primary" @click="loadMoreListings">Load More</button>
                    </div>
                </div>
            </div>

            <!-- Price History Modal -->
            <div v-if="showModal" class="modal" @click="showModal = false">
                <div class="modal-content" @click.stop>
                    <div class="modal-header">
                        <h2>Price History</h2>
                        <button class="modal-close" @click="showModal = false">&times;</button>
                    </div>
                    <div v-if="selectedListing">
                        <h3>{{ selectedListing.title }}</h3>
                        <div style="margin: 1rem 0;">
                            <strong>Current Price:</strong>
                            <span style="color: #667eea; font-size: 1.5rem; font-weight: bold;">
                                {{ selectedListing.price_cents ? (selectedListing.price_cents / 100).toFixed(2) : 'N/A' }} {{ selectedListing.currency || 'EUR' }}
                            </span>
                        </div>
                        <div v-if="selectedListing.seller_name">
                            <strong>Seller:</strong> {{ selectedListing.seller_name }}
                        </div>
                        <div v-if="selectedListing.location">
                            <strong>Location:</strong> {{ selectedListing.location }}
                        </div>
                        <a :href="selectedListing.url" target="_blank" style="color: #667eea;">View on Vinted</a>

                        <div class="price-history-chart">
                            <h3>Price Changes</h3>
                            <div v-if="selectedListing.price_history && selectedListing.price_history.length > 0">
                                <div v-for="history in selectedListing.price_history" :key="history.id" class="price-history-item">
                                    <div>
                                        <strong>{{ (history.price_cents / 100).toFixed(2) }} {{ history.currency || 'EUR' }}</strong>
                                    </div>
                                    <div style="color: #999;">
                                        {{ new Date(history.observed_at).toLocaleString() }}
                                    </div>
                                </div>
                            </div>
                            <div v-else style="color: #999; padding: 2rem; text-align: center;">
                                No price changes recorded yet
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Configs Tab -->
            <div v-if="currentTab === 'configs'">
                <div class="card">
                    <h2>Scrape Configurations</h2>
                    <button class="btn btn-primary" @click="showConfigForm = !showConfigForm" style="margin-bottom: 2rem;">
                        {{ showConfigForm ? 'Cancel' : '+ New Configuration' }}
                    </button>

                    <!-- New Config Form -->
                    <div v-if="showConfigForm" class="card" style="background: #f9f9f9;">
                        <h3>Create Scrape Configuration</h3>
                        <form @submit.prevent="createConfig">
                            <div class="form-group">
                                <label>Name</label>
                                <input v-model="newConfig.name" required placeholder="e.g., PS5 Games Monitor">
                            </div>
                            <div class="form-group">
                                <label>Search Text</label>
                                <input v-model="newConfig.search_text" required placeholder="e.g., ps5">
                            </div>
                            <div class="form-group">
                                <label>Categories (comma separated IDs)</label>
                                <input v-model="newConfig.categoriesInput" placeholder="e.g., 3026">
                                <small style="color: #666;">
                                    Common: 2994 (Electronics), 3026 (Video Games), 1953 (Computers)
                                    <br>Use 'vinted-scraper categories' to see all
                                </small>
                            </div>
                            <div class="form-group">
                                <label>Platform IDs (comma separated, for video games)</label>
                                <input v-model="newConfig.platformsInput" placeholder="e.g., 1281, 1280">
                                <small style="color: #666;">
                                    PlayStation: 1281 (PS5), 1280 (PS4), 1279 (PS3)
                                    <br>Xbox: 1282 (Series X/S), 1283 (One), 1284 (360)
                                    <br>Nintendo: 1288 (Switch), 1289 (Wii U), 1290 (Wii)
                                    <br>Use 'vinted-scraper platforms' to see all
                                </small>
                            </div>
                            <div class="form-group">
                                <label>Max Pages</label>
                                <input v-model.number="newConfig.max_pages" type="number" min="1" required>
                            </div>
                            <div class="form-group">
                                <label>Delay (seconds)</label>
                                <input v-model.number="newConfig.delay" type="number" step="0.1" min="0.1" required>
                            </div>
                            <div class="form-group">
                                <label>Cron Schedule (optional)</label>
                                <input v-model="newConfig.cron_schedule" placeholder="e.g., 0 */6 * * * (every 6 hours)">
                            </div>
                            <button type="submit" class="btn btn-success">Create Configuration</button>
                        </form>
                    </div>

                    <!-- Config List -->
                    <div v-if="loadingConfigs" class="loading">Loading configurations...</div>
                    <div v-else-if="configs.length === 0" class="empty-state">
                        No configurations yet. Create one to start scraping!
                    </div>
                    <div v-else class="config-list">
                        <div v-for="config in configs" :key="config.id" class="config-item">
                            <div class="config-info">
                                <h3>{{ config.name }}</h3>
                                <p><strong>Search:</strong> {{ config.search_text }}</p>
                                <p><strong>Pages:</strong> {{ config.max_pages }} | <strong>Delay:</strong> {{ config.delay }}s</p>
                                <p v-if="config.cron_schedule"><strong>Schedule:</strong> {{ config.cron_schedule }}</p>
                                <p v-if="config.last_run_at">
                                    <strong>Last Run:</strong> {{ new Date(config.last_run_at).toLocaleString() }}
                                    <span v-if="config.last_run_status" class="status-badge" :class="'status-' + config.last_run_status">
                                        {{ config.last_run_status }}
                                    </span>
                                    <span v-if="config.last_run_items"> ({{ config.last_run_items }} items)</span>
                                </p>
                            </div>
                            <div class="config-actions">
                                <button class="btn btn-success" @click="runConfig(config.id)">Run Now</button>
                                <button class="btn btn-danger" @click="deleteConfig(config.id)">Delete</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    currentTab: 'dashboard',
                    viewMode: 'grid',
                    stats: {},
                    listings: [],
                    configs: [],
                    searchQuery: '',
                    loadingListings: false,
                    loadingConfigs: false,
                    showConfigForm: false,
                    showModal: false,
                    selectedListing: null,
                    listingsPage: 0,
                    listingsLimit: 50,
                    newConfig: {
                        name: '',
                        search_text: '',
                        categoriesInput: '',
                        platformsInput: '',
                        max_pages: 5,
                        delay: 1.0,
                        cron_schedule: '',
                        fetch_details: false,
                        is_active: true
                    }
                }
            },
            mounted() {
                this.loadStats();
                this.loadListings();
                this.loadConfigs();
            },
            methods: {
                async loadStats() {
                    try {
                        const response = await axios.get('http://localhost:8000/api/stats');
                        this.stats = response.data;
                    } catch (error) {
                        console.error('Failed to load stats:', error);
                    }
                },
                async loadListings() {
                    this.loadingListings = true;
                    try {
                        const response = await axios.get('http://localhost:8000/api/listings', {
                            params: {
                                skip: this.listingsPage * this.listingsLimit,
                                limit: this.listingsLimit,
                                search: this.searchQuery || undefined
                            }
                        });
                        this.listings = response.data;
                    } catch (error) {
                        console.error('Failed to load listings:', error);
                    } finally {
                        this.loadingListings = false;
                    }
                },
                async loadMoreListings() {
                    this.listingsPage++;
                    this.loadingListings = true;
                    try {
                        const response = await axios.get('http://localhost:8000/api/listings', {
                            params: {
                                skip: this.listingsPage * this.listingsLimit,
                                limit: this.listingsLimit,
                                search: this.searchQuery || undefined
                            }
                        });
                        this.listings.push(...response.data);
                    } catch (error) {
                        console.error('Failed to load more listings:', error);
                    } finally {
                        this.loadingListings = false;
                    }
                },
                searchListings() {
                    this.listingsPage = 0;
                    this.loadListings();
                },
                async loadConfigs() {
                    this.loadingConfigs = true;
                    try {
                        const response = await axios.get('http://localhost:8000/api/configs');
                        this.configs = response.data;
                    } catch (error) {
                        console.error('Failed to load configs:', error);
                    } finally {
                        this.loadingConfigs = false;
                    }
                },
                async createConfig() {
                    try {
                        const categories = this.newConfig.categoriesInput
                            ? this.newConfig.categoriesInput.split(',').map(c => parseInt(c.trim())).filter(c => !isNaN(c))
                            : null;

                        const platforms = this.newConfig.platformsInput
                            ? this.newConfig.platformsInput.split(',').map(p => parseInt(p.trim())).filter(p => !isNaN(p))
                            : null;

                        const payload = {
                            name: this.newConfig.name,
                            search_text: this.newConfig.search_text,
                            categories: categories,
                            platform_ids: platforms,
                            max_pages: this.newConfig.max_pages,
                            per_page: 24,
                            delay: this.newConfig.delay,
                            fetch_details: this.newConfig.fetch_details,
                            cron_schedule: this.newConfig.cron_schedule || null,
                            is_active: this.newConfig.is_active
                        };

                        await axios.post('http://localhost:8000/api/configs', payload);
                        alert('Configuration created successfully!');
                        this.showConfigForm = false;
                        this.loadConfigs();
                        this.loadStats();

                        // Reset form
                        this.newConfig = {
                            name: '',
                            search_text: '',
                            categoriesInput: '',
                            platformsInput: '',
                            max_pages: 5,
                            delay: 1.0,
                            cron_schedule: '',
                            fetch_details: false,
                            is_active: true
                        };
                    } catch (error) {
                        console.error('Failed to create config:', error);
                        alert('Failed to create configuration: ' + (error.response?.data?.detail || error.message));
                    }
                },
                async runConfig(configId) {
                    if (!confirm('Start scraping now?')) return;

                    try {
                        await axios.post(`http://localhost:8000/api/configs/${configId}/run`);
                        alert('Scraping started! This may take a while.');
                        setTimeout(() => {
                            this.loadConfigs();
                            this.loadStats();
                            this.loadListings();
                        }, 3000);
                    } catch (error) {
                        console.error('Failed to run config:', error);
                        alert('Failed to start scraping: ' + (error.response?.data?.detail || error.message));
                    }
                },
                async deleteConfig(configId) {
                    if (!confirm('Delete this configuration?')) return;

                    try {
                        await axios.delete(`http://localhost:8000/api/configs/${configId}`);
                        alert('Configuration deleted');
                        this.loadConfigs();
                        this.loadStats();
                    } catch (error) {
                        console.error('Failed to delete config:', error);
                        alert('Failed to delete configuration');
                    }
                },
                async showPriceHistory(listingId) {
                    try {
                        const response = await axios.get(`http://localhost:8000/api/listings/${listingId}`);
                        this.selectedListing = response.data;
                        this.showModal = true;
                    } catch (error) {
                        console.error('Failed to load listing details:', error);
                        alert('Failed to load price history');
                    }
                }
            }
        }).mount('#app');
    </script>
</body>
</html>
